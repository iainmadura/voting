"use strict";(self.webpackChunkjadwal=self.webpackChunkjadwal||[]).push([[271],{271:(L,T,s)=>{s.r(T),s.d(T,{VoteModule:()=>d});var m=s(6895),f=s(9299),t=s(4650);class _{}_.\u0275fac=function(e){return new(e||_)},_.\u0275cmp=t.Xpm({type:_,selectors:[["app-vote"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},dependencies:[f.lC]});var h=s(5861),x=s(3176),c=s(1380),w=s(4882),b=s(8318);function C(n,e){if(1&n&&(t.TgZ(0,"div",12),t._uU(1),t.qZA()),2&n){const i=t.oxw(3);t.xp6(1),t.Oqu(i.item.title)}}function A(n,e){1&n&&(t.TgZ(0,"div",13),t._uU(1," Terima kasih atas partisipasi Anda. Pilihan Anda telah berhasil tercatat, dan kesempatan untuk memilih hanya tersedia satu kali. "),t.qZA())}function I(n,e){if(1&n&&(t.TgZ(0,"div",13),t._uU(1),t.qZA()),2&n){const i=t.oxw(3);t.xp6(1),t.AsE(" Batas maksimal vote yang dapat Anda berikan adalah ",i.session.max_vote," untuk ",i.session.name,". Jika ingin mengubah pilihan, silakan batalkan salah satu vote yang sudah ada. ")}}function V(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.vote())}),t._uU(1," VOTE "),t.qZA()}}function U(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(3);return t.KtG(o.unvote())}),t._uU(1," BATAL VOTE "),t.qZA()}}function D(n,e){if(1&n&&(t.TgZ(0,"div",3)(1,"div",4),t.YNc(2,C,2,1,"div",5),t._UZ(3,"img",6),t.qZA(),t.TgZ(4,"div",7),t._UZ(5,"div",8),t.YNc(6,A,2,0,"div",9),t.YNc(7,I,2,2,"div",9),t.YNc(8,V,2,0,"button",10),t.YNc(9,U,2,0,"button",11),t.qZA()()),2&n){const i=t.oxw(2);t.xp6(2),t.Q6J("ngIf",i.item.title),t.xp6(1),t.Q6J("src",i.item.image,t.LSH),t.xp6(2),t.Q6J("innerHTML",i.item.description,t.oJD),t.xp6(1),t.Q6J("ngIf",(i.item.voting||i.isMaxVote())&&1===i.session.confirmed),t.xp6(1),t.Q6J("ngIf",!i.item.voting&&i.isMaxVote()&&0===i.session.confirmed),t.xp6(1),t.Q6J("ngIf",!i.isMaxVote()&&!i.item.voting),t.xp6(1),t.Q6J("ngIf",i.item.voting&&0===i.session.confirmed)}}function y(n,e){if(1&n&&(t.TgZ(0,"div",1),t.YNc(1,D,10,7,"div",2),t.qZA()),2&n){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.item)}}class p{constructor(e,i){this.material=e,this.helper=i,this.sendVoting=!1,this.ready=!1,this.item=null,this.session=null,this.criteria_data=[]}close(){this.modal?.close()}onInput(e,i){const a=this.material.loading();this.item=i.criteria,this.criteria_data=i.criteria_data,this.session=i.session,this.item.description&&(this.item.description=this.renderInnerHTML(this.item.description)),this.modal=e,setTimeout(()=>{this.ready=!0,a.close()},2e3)}isMaxVote(){return this.criteria_data.filter(e=>e.voting).length>=this.session.max_vote}renderInnerHTML(e){return this.helper.safeHtml(e)}unvote(){var e=this;return(0,h.Z)(function*(){if(e.sendVoting)return;e.sendVoting=!0;const i=e.material.loading();if(yield c.$.send("unvoteCriteria",{session:e.session.id,criteria:e.item.id,token:localStorage.getItem("token_auth")})){e.material.toast("Voting berhasil dibatalkan"),e.item.voting=0;const o=e.criteria_data.map(r=>r.id).indexOf(e.item.id);-1!==o&&(e.criteria_data[o].voting=0)}else e.material.alert("Anda tidak dapat melakukan voting, silahkan akses kembali dari sate!","Kesalahan");i.close(),e.sendVoting=!1})()}vote(){var e=this;return(0,h.Z)(function*(){if(e.sendVoting)return;e.sendVoting=!0;const i=function(){var a=(0,h.Z)(function*(){const o=e.material.loading();if(yield c.$.send("voteCriteria",{session:e.session.id,criteria:e.item.id,token:localStorage.getItem("token_auth")})){e.material.toast("Voting berhasil disimpan"),e.item.voting=1;const v=e.criteria_data.map(k=>k.id).indexOf(e.item.id);-1!==v&&(e.criteria_data[v].voting=1)}else e.material.alert("Anda tidak dapat melakukan voting, silahkan akses kembali dari sate!","Kesalahan");o.close(),e.sendVoting=!1});return function(){return a.apply(this,arguments)}}();e.session.confirmed?(yield e.material.confirm("Vote hanya diberikan "+e.session.max_vote+"x kesempatan, lanjut untuk menentukan vote?"))?i():e.sendVoting=!1:i()})()}ngOnInit(){}}p.\u0275fac=function(e){return new(e||p)(t.Y36(b.U),t.Y36(x.W))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-detail-vote"]],decls:1,vars:1,consts:[["class","p-0",4,"ngIf"],[1,"p-0"],["class","row",4,"ngIf"],[1,"row"],[1,"col-12","col-md-5","col-lg-4","mb-3"],["class","h3",4,"ngIf"],["alt","",1,"img-fluid","w-100",3,"src"],[1,"col-12","col-md-7","col-lg-8","mb-3"],[3,"innerHTML"],["class","alert alert-danger",4,"ngIf"],["class","mt-3 btn btn-success btn-lg w-100",3,"click",4,"ngIf"],["class","mt-3 btn btn-danger btn-lg w-100",3,"click",4,"ngIf"],[1,"h3"],[1,"alert","alert-danger"],[1,"mt-3","btn","btn-success","btn-lg","w-100",3,"click"],[1,"mt-3","btn","btn-danger","btn-lg","w-100",3,"click"]],template:function(e,i){1&e&&t.YNc(0,y,2,1,"div",0),2&e&&t.Q6J("ngIf",i.ready)},dependencies:[m.O5]});var q=s(6858),Z=s(9450);function j(n,e){if(1&n&&(t.TgZ(0,"div",9)(1,"a",10),t._UZ(2,"div",11),t.TgZ(3,"div"),t._uU(4),t.qZA()(),t.TgZ(5,"div",12),t._uU(6),t.qZA()()),2&n){const i=t.oxw();t.xp6(4),t.Oqu(i.user.name),t.xp6(2),t.hij(" ",i.user.code," ")}}function J(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(i);const o=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.playVote(o))}),t._UZ(1,"i",31),t._uU(2," Vote "),t.qZA()}}function M(n,e){1&n&&(t.TgZ(0,"li"),t._uU(1," 1x kesempatan memilih (tidak dapat diganti) "),t.qZA())}function O(n,e){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&n){const i=t.oxw().$implicit,a=t.oxw(2);t.xp6(1),t.hij(" Dapat mengubah pilihan (vote) hari tanggal ",a.formatDateTime(i.date_end)," ")}}function S(n,e){if(1&n&&(t.TgZ(0,"tr",19)(1,"td",24),t._uU(2),t.qZA(),t.TgZ(3,"td",25)(4,"div"),t._uU(5),t.qZA(),t.YNc(6,J,3,0,"button",26),t.qZA(),t.TgZ(7,"td")(8,"div",27)(9,"strong"),t._uU(10,"Start: "),t.qZA(),t._uU(11),t.qZA(),t.TgZ(12,"div",27)(13,"strong"),t._uU(14,"End: "),t.qZA(),t._uU(15),t.qZA()(),t.TgZ(16,"td",25)(17,"ol",28)(18,"li"),t._uU(19),t.qZA(),t.TgZ(20,"li"),t._uU(21),t.qZA(),t.YNc(22,M,2,0,"li",29),t.YNc(23,O,2,1,"li",29),t.TgZ(24,"li"),t._uU(25," Voting bersifat langsung, khusus, jujur, bebas, dan rahasia "),t.qZA()()()()),2&n){const i=e.$implicit,a=e.index,o=t.oxw(2);t.xp6(2),t.Oqu(a+1),t.xp6(3),t.Oqu(i.name),t.xp6(1),t.Q6J("ngIf",1===i.voting),t.xp6(5),t.hij(" ",o.formatDateTime(i.date_start)," "),t.xp6(4),t.hij(" ",o.formatDateTime(i.date_end)," "),t.xp6(4),t.AsE(" Total Kriteria: ",i.total_criteria," ",i.name," "),t.xp6(2),t.AsE(" Maks memilih: ",i.max_vote," ",i.name," "),t.xp6(1),t.Q6J("ngIf",i.confirmed),t.xp6(1),t.Q6J("ngIf",!i.confirmed)}}function Y(n,e){if(1&n&&(t.TgZ(0,"div",13)(1,"div",14),t._uU(2,"Aplikasi Voting"),t.qZA(),t.TgZ(3,"div"),t._uU(4,"Session Voting"),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"div",15)(7,"div",16)(8,"div",17)(9,"table",18)(10,"thead")(11,"tr",19)(12,"th",20),t._uU(13,"#"),t.qZA(),t.TgZ(14,"th",21),t._uU(15,"Nama Voting"),t.qZA(),t.TgZ(16,"th",22),t._uU(17,"Tanggal Vote"),t.qZA(),t.TgZ(18,"th",21),t._uU(19,"Ketentuan"),t.qZA()()(),t.TgZ(20,"tbody"),t.YNc(21,S,26,11,"tr",23),t.qZA()()()()()()),2&n){const i=t.oxw();t.xp6(21),t.Q6J("ngForOf",i.jadwal)}}function N(n,e){1&n&&t._UZ(0,"div",42)}function Q(n,e){if(1&n&&(t.TgZ(0,"div",43),t._uU(1),t.qZA()),2&n){const i=t.oxw().$implicit;t.xp6(1),t.hij(" ",i.title," ")}}function F(n,e){if(1&n&&t._UZ(0,"img",44),2&n){const i=t.oxw().$implicit;t.Q6J("src",i.image,t.LSH)}}function $(n,e){if(1&n&&(t.TgZ(0,"div",45),t._uU(1),t.qZA()),2&n){const i=t.oxw().$implicit,a=t.oxw(2);t.xp6(1),t.hij(" ",a.formatDescription(i.description)," ")}}const K=function(n){return{active:n}},H=function(n){return{"bg-success":n}};function P(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div",35)(1,"div",36),t.NdJ("click",function(){const o=t.CHM(i),r=o.$implicit,v=o.index,k=t.oxw(2);return t.KtG(k.viewVote(r,v))}),t.TgZ(2,"div",37),t.YNc(3,N,1,0,"div",38),t.YNc(4,Q,2,1,"div",39),t.YNc(5,F,1,1,"img",40),t.YNc(6,$,2,1,"div",41),t.qZA()()()}if(2&n){const i=e.$implicit;t.Q6J("ngClass",t.VKq(7,K,i.voting)),t.xp6(1),t.Tol(t.VKq(9,H,i.voting)),t.xp6(2),t.Q6J("ngIf",i.voting),t.xp6(1),t.Q6J("ngIf",i.title),t.xp6(1),t.Q6J("ngIf",i.image),t.xp6(1),t.Q6J("ngIf",i.description)}}function E(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div",13)(1,"div",14),t._uU(2),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA(),t._UZ(5,"hr"),t.TgZ(6,"button",32),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.back())}),t._UZ(7,"i",33),t._uU(8," Kembali "),t.qZA(),t.TgZ(9,"div",15),t.YNc(10,P,7,11,"div",34),t.qZA()()}if(2&n){const i=t.oxw();t.xp6(2),t.Oqu(i.jadwal_select.name),t.xp6(2),t.hij("List Kriteria (",i.jadwal_select.total_criteria,")"),t.xp6(6),t.Q6J("ngForOf",i.criteria)}}class u{constructor(e,i,a,o){this.http=e,this.helper=i,this.material=a,this.page=o,this.jadwal_select=null,this.jadwal=[],this.criteria=[],this.user={name:"",code:""},this.item=null}getJadwa(){}viewVote(e,i){this.item=e,this.material.modal({title:"Detail Voting",component:p,config:{width:"1200px"},data:{criteria:e,session:this.jadwal_select,criteria_data:this.criteria},handlerInputData:"onInput",handlerSubmitModal:!1,textCancel:"Tutup"})}back(){this.jadwal_select=null,this.item=null}playVote(e){this.jadwal_select=e,c.$.send("jadwalSessionDetail",{id:e.id,token:localStorage.getItem("token_auth")}).then(i=>{this.criteria=i})}formatDescription(e){return x.W.html2Text(e)}formatDateTime(e){return w.d.formatDateTimeID(e)}ngOnInit(){var e=this;return(0,h.Z)(function*(){if(localStorage.getItem("token_auth")){const i=yield c.$.send("api-token",localStorage.getItem("token_auth"));i.status?(e.user.code=i.data.user.kode,e.user.name=i.data.user.profil.nama):e.page.setUrl("vote/sso/need_token"),c.$.on("reloadVoting").subscribe(a=>{if(e.jadwal_select&&e.jadwal_select.id===a.session){const o=e.criteria.map(r=>r.id).indexOf(a.criteria);-1!==o&&(e.criteria[o].voting="vote"===a.type?1:null)}}),c.$.on("jadwalSession").subscribe(a=>{e.helper.zone(()=>{e.jadwal=a})}),c.$.send("jadwalSession",localStorage.getItem("token_auth"))}else e.page.setUrl("vote/sso/need_token")})()}}u.\u0275fac=function(e){return new(e||u)(t.Y36(q.O),t.Y36(x.W),t.Y36(b.U),t.Y36(Z.P))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-dashboard"]],decls:13,vars:3,consts:[["id","appVue",1,"full-screen"],[1,"container","my-3"],[1,"row","justify-content-center"],[1,"col-12","col-lg-8"],[1,"alert","alert-danger"],[1,"card"],["data-bs-theme","dark",1,"navbar","rounded-2","rounded-bottom-0","bg-primary"],["class","container-fluid",4,"ngIf"],["class","card-body shadow",4,"ngIf"],[1,"container-fluid"],["href","javascript:void(0)",1,"navbar-brand","d-flex","gap-1","align-items-center"],[1,"img-profil","img-thumbnail","rounded-pill"],[1,"text-muted","small","text-truncate"],[1,"card-body","shadow"],[1,"h3"],[1,"row"],[1,"col-12jadwal"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"text-center"],["scope","col"],["scope","col",1,"text-start"],["scope","col","width","320px"],["class","text-center",4,"ngFor","ngForOf"],["scope","row"],[1,"text-start"],["class","btn btn-sm btn-success",3,"click",4,"ngIf"],[1,"small"],["type","1"],[4,"ngIf"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"fas","fa-play"],[1,"btn","btn-warning","mb-4",3,"click"],[1,"fas","fa-arrow-left"],["class","col-12 col-md-4 mb-3 criteria",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-12","col-md-4","mb-3","criteria",3,"ngClass"],[1,"card","rounded-5","shadow-sm",3,"click"],[1,"card-body"],["class","icon-selected-vote",4,"ngIf"],["class","title-criteria fw-bold",4,"ngIf"],["class","image-criteria w-100","alt","",3,"src",4,"ngIf"],["class","description-criteria fst-italic text-muted text-truncate",4,"ngIf"],[1,"icon-selected-vote"],[1,"title-criteria","fw-bold"],["alt","",1,"image-criteria","w-100",3,"src"],[1,"description-criteria","fst-italic","text-muted","text-truncate"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5," Akun akan keluar otomatis "),t.TgZ(6,"strong"),t._uU(7,"Apabila anda logout dari aplikasi sate"),t.qZA()(),t.TgZ(8,"div",5)(9,"nav",6),t.YNc(10,j,7,2,"div",7),t.qZA(),t.YNc(11,Y,22,1,"div",8),t.YNc(12,E,11,3,"div",8),t.qZA()()()()()),2&e&&(t.xp6(10),t.Q6J("ngIf",i.user),t.xp6(1),t.Q6J("ngIf",!i.jadwal_select),t.xp6(1),t.Q6J("ngIf",i.jadwal_select))},dependencies:[m.mk,m.sg,m.O5],styles:[".full-screen[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;min-height:100vh;width:100%}.img-profil[_ngcontent-%COMP%]{background:url(https://api.iainmadura.ac.id/assets/imgs/iainmadura-logo.png);background-size:cover;background-position:top;width:45px;height:45px;background-color:#fff}.icon-selected-vote[_ngcontent-%COMP%]{background:url(like.8c13f067cea8575c.png);background-size:cover;background-position:top;width:45px;height:45px;position:absolute;top:0;right:0;z-index:1}.criteria[_ngcontent-%COMP%]{cursor:pointer;position:relative}.criteria.active[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:#fff!important}.criteria.active[_ngcontent-%COMP%]   .image-criteria[_ngcontent-%COMP%]{opacity:.7}"]});class g{constructor(e,i,a){this.page=e,this.route=i,this.material=a,e.register(i)}ngOnInit(){this.page.getParam("token",e=>{e?c.$.send("api-token",e).then(i=>{i.status?(localStorage.setItem("token_auth",e),this.page.setUrl("vote/dashboard")):(localStorage.removeItem("token_auth"),this.material.alert("Silahkan akses kembali dari sate!","Tidak dapat masuk"))}):localStorage.getItem("token_auth")?c.$.send("api-token",localStorage.getItem("token_auth")).then(i=>{i.status?this.page.setUrl("vote/dashboard"):(localStorage.removeItem("token_auth"),this.material.alert("Silahkan akses kembali dari sate!","Tidak dapat masuk"))}):(localStorage.removeItem("token_auth"),this.material.alert("Silahkan akses kembali dari sate!","Tidak dapat masuk"))})}}g.\u0275fac=function(e){return new(e||g)(t.Y36(Z.P),t.Y36(f.gz),t.Y36(b.U))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-sso-token"]],decls:1,vars:0,consts:[[1,"text-center"]],template:function(e,i){1&e&&t._UZ(0,"div",0)}});const z=[{path:"sso/:token",component:g},{path:"",component:_,children:[{path:"dashboard",component:u},{redirectTo:"dashboard",path:"",pathMatch:"full"}]}];class l{}l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[f.Bz.forChild(z),f.Bz]});class d{}d.\u0275fac=function(e){return new(e||d)},d.\u0275mod=t.oAB({type:d}),d.\u0275inj=t.cJS({imports:[m.ez,l]})}}]);